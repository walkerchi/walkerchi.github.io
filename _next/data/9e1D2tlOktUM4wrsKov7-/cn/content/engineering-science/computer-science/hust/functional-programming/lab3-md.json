{"pageProps":{"frontmatter":{"title":"[华科]函数式编程实验3","description":"华中科技大学 函数式编程实验3题目与答案","date":"2021-5-2","image":"https://s2.loli.net/2022/06/18/BryAis3WRkCItMg.jpg"},"content":"<h1>Lab3</h1><h2>Q1</h2><p>编写函数listToTree: int list -> tree，将一个表转换成一棵平衡树</p><p>提示：可调用split函数，split函数定义如下： 如果L非空，则存在L1, x, L2，满足： split L = (L1, x, L2) 且 L = L1 @ x :: L2 且 length(L1)和length(L2)差值小于1。</p><pre><code>datatype tree = Empty | Node of tree*int*tree;\r\n\r\nfun split (x:int list):(int list*int*int list) = \r\n\tlet \r\n\t\tval ind = (List.length(x) div 2)\r\n\t\tval y::R = List.drop(x,ind)\r\n\t\tval L    = List.take(x,ind)\r\n\tin\r\n\t\t(L,y,R)\r\n\tend;\r\n\t\r\nfun listToTree ([]:int list):tree = Empty\r\n  | listToTree ([x]:int list):tree = Node(Empty,x,Empty)\r\n  | listToTree (X:int list):tree = \r\n  \t\tlet \r\n  \t\t\tval (L,x,R) = split(X)\r\n  \t\tin \r\n  \t\t\tNode(listToTree(L),x,listToTree(R))\r\n  \t\tend;\r\n\r\n  \t\t\t\n</code></pre><h2>Q2</h2><p>编写函数revT: tree -> tree，对树进行反转，使trav(revT t) = reverse(trav t)。（trav为树的中序遍历函数）。假设输入参数为一棵平衡二叉树，验证程序的正确性，并分析该函数的执行性能（work和span）</p><p><span class=\"math math-inline\">Span_{revT} = O(d)</span></p><p><span class=\"math math-inline\">Work_{revT} = O(n)</span></p><pre><code>datatype tree = Empty | Node of tree*int*tree;\r\n\r\nfun trav (Empty:tree):int list = []\r\n  | trav (Node(l,x,r):tree):int list = \r\n  \t\tlet \r\n  \t\t\tval L = trav l\r\n\t\t\tval R = trav r\r\n\t\tin \r\n\t\t\tL@[x]@R\r\n\t\tend;\r\n\t\t\r\n\r\nfun revT (Empty:tree):tree = Empty\r\n  | revT (Node(l,x,r):tree):tree = Node(revT r, x, revT l);\r\n  \r\n\r\n\r\nfun reverse (x:int list):int list = List.rev(x);\n</code></pre><h2>Q3</h2><p>编写函数binarySearch: tree * int -> bool。当输出参数1为有序树时，如果树中包含值为参数2的节点，则返回true；否则返回false。要求：程序中请使用函数Int.compare（系统提供），不要使用&#x3C;, =, >。 datatype order = GREATER | EQUAL | LESS case Int.compare(x1, x2) of GREATER => (* x1 > x2 <em>) | EQUAL => (</em> x1 = x2 <em>) | LESS => (</em> x1 &#x3C; x2 *)</p><pre><code>datatype tree = Empty | Node of tree*int*tree;\r\ndatatype order = GREATER | EQUAL | LESS\r\n\r\nfun binarySearch (Empty:tree,y:int):bool = false\r\n  | binarySearch (Node(Empty,x,Empty):tree,y:int):bool = (x=y)\r\n  | binarySearch (Node(l,x,r):tree,y:int):bool = \r\n  \t\tcase Int.compare(x,y) of\r\n  \t\t\tGREATER => binarySearch(l,y)\r\n  \t\t\t| EQUAL => true\r\n  \t\t\t| LESS  => binarySearch(r,y);\n</code></pre><h2>Q4</h2><p>一棵minheap树定义为：</p><ol><li>t is Empty;</li><li>t is a Node(L, x, R), where R, L are minheaps and values(L), value(R) >= x\t(value(T)函数用于获取树T的根节点的值）</li></ol><p>编写函数treecompare, SwapDown 和heapify：</p><pre><code>treecompare: tree * tree -> order (* when given two trees, returns a value of type order, based on which tree has a larger value at the root node *) \r\n\r\nSwapDown: tree -> tree (* REQUIRES the subtrees of t are both minheaps * ENSURES swapDown(t) = if t is Empty or all of t’s immediate children are empty then * just return t, otherwise returns a minheap which contains exactly the elements in t. *) \r\n\r\nheapify : tree -> tree (* given an arbitrary tree t, evaluates to a minheap with exactly the elements of t.  *)\n</code></pre><p>分析SwapDown 和heapify两个函数的work和span</p><p><span class=\"math math-inline\">Span_{SwapDown}=O(d)</span></p><p><span class=\"math math-inline\">Work_{SwapDown}=O(d)</span></p><p><span class=\"math math-inline\">Span_{heapify}=O(d^2)</span></p><p><span class=\"math math-inline\">Work_{heapify}=O(nlogn)</span></p><pre><code>datatype tree = Empty | Node of tree*int*tree;\r\ndatatype order = GREATER | EQUAL | LESS\r\n\r\nfun treecompare (Empty, Empty) = EQUAL\r\n  | treecompare (X, Empty) = GREATER\r\n  | treecompare (Empty, Y) = LESS\r\n  | treecompare (Node(l1,x1,r1),Node(l2,x2,r2)) = Int.compare(x1,x2);\r\n  \t\t\t\r\nfun SwapDown (Empty:tree):tree = Empty\r\n  | SwapDown (Node(Empty,x,Empty):tree):tree = Node(Empty, x, Empty)\r\n  | SwapDown (Node(Empty,x,r):tree):tree = \r\n        let  \r\n            val Node(rl, rx, rr) = SwapDown r \r\n        in \r\n            case Int.compare(rx, x) of\r\n                LESS => Node(Empty, rx, Node(rl, x, rr))\r\n                | _  => Node(Empty, x,  Node(rl, rx,rr))\r\n        end\r\n  | SwapDown (Node(l,x,Empty):tree):tree = \r\n        let \r\n            val Node(ll,lx,lr) = SwapDown l \r\n        in\r\n            case Int.compare(lx, x) of\r\n                LESS => Node(Node(ll,x,lr), lx, Empty)\r\n                | _  => Node(Node(ll,lx,lr),x , Empty)\r\n        end\r\n  | SwapDown (Node(l,x,r):tree):tree = \r\n  \t\tlet \r\n  \t\t\tval Node(ll, lx, lr) = SwapDown l\r\n  \t\t\tval Node(rl, rx, rr) = SwapDown r\r\n  \t\tin\r\n  \t\t\tcase Int.compare(lx, rx) of\r\n  \t\t\t\tGREATER => (case Int.compare(rx, x) of\r\n                \t\t\tLESS => Node(Node(ll,lx,lr),rx,Node(rl,x,rr))\r\n                        \t| _ => Node(Node(ll,lx,lr),x,Node(rl,rx,rr))\r\n                            )\r\n                | LESS  => (case Int.compare(lx, x) of\r\n                 \t\t\tLESS => Node(Node(ll,x,lr),lx,Node(rl,rx,rr))\r\n                 \t\t\t| _  => Node(Node(ll,lx,lr),x,Node(rl,rx,rr))\r\n                            )\r\n                | EQUAL => Node(Node(ll,lx,lr),x,Node(rl,rx,rr)) \r\n         end;    \r\n         \r\n fun balance (T:tree):tree = listToTree(trav T);\r\n         \r\n fun heapify_helper(Empty:tree):tree = Empty\r\n   | heapify_helper(T:tree):tree = \r\n   \t\tlet \r\n            val Node(sd_l, sd_x, sd_r) = SwapDown T\r\n   \t\tin\r\n   \t\t\tNode( SwapDown sd_l, sd_x, SwapDown sd_r )\r\n   \t\tend\r\n         \r\n fun heapify (T:tree):tree = heapify_helper(balance T);\n</code></pre>","renderType":"md","imageProps":{"src":"https://s2.loli.net/2022/06/18/BryAis3WRkCItMg.jpg","width":1920,"height":1080,"type":"jpg","blurDataURL":"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAADAAQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAb/xAAfEAAABgEFAAAAAAAAAAAAAAAAAQIDBAURBhMhMWH/xAAUAQEAAAAAAAAAAAAAAAAAAAAG/8QAGREBAQEAAwAAAAAAAAAAAAAAAQIAERJR/9oADAMBAAIRAxEAPwCCtLl6HqC5ZZh06kFMXjdqYrpl1xlTZnjwAAN5iU5TE+9AA+b/2Q=="},"language":"cn"},"__N_SSG":true}