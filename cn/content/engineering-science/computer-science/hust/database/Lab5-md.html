<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/icon/hexogen.svg"/><title>Walkerchi | walkerchi&#x27;s homepage</title><meta name="robots" content="index,follow"/><meta name="description" content="The Homepage Website of walkerchi"/><meta property="og:title" content="Walkerchi | walkerchi&#x27;s homepage"/><meta property="og:description" content="The Homepage Website of walkerchi"/><meta name="next-head-count" content="8"/><link rel="preload" href="./_next/static/css/000780a15b7c1cbd.css" as="style"/><link rel="stylesheet" href="./_next/static/css/000780a15b7c1cbd.css" data-n-g=""/><link rel="preload" href="./_next/static/css/e9521474bbd05bad.css" as="style"/><link rel="stylesheet" href="./_next/static/css/e9521474bbd05bad.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="./_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="./_next/static/chunks/webpack-1d70a8de7a21dd19.js" defer=""></script><script src="./_next/static/chunks/framework-75db3117d1377048.js" defer=""></script><script src="./_next/static/chunks/main-30435f12318d8710.js" defer=""></script><script src="./_next/static/chunks/pages/_app-c29e8ded51aeee7d.js" defer=""></script><script src="./_next/static/chunks/4ad82c5e-0dc209747f2c5278.js" defer=""></script><script src="./_next/static/chunks/542b50fd-4032e53bb43a3093.js" defer=""></script><script src="./_next/static/chunks/675-ed166fdce2eef928.js" defer=""></script><script src="./_next/static/chunks/568-25d1c2389425a4bc.js" defer=""></script><script src="./_next/static/chunks/201-55f2f15b237a96f9.js" defer=""></script><script src="./_next/static/chunks/529-60cdf8df29f46e3c.js" defer=""></script><script src="./_next/static/chunks/pages/%5Blang%5D/content/%5B...slug%5D-6375ae090a346a72.js" defer=""></script><script src="./_next/static/7Uv-H1eeK5mnpOygBEt0K/_buildManifest.js" defer=""></script><script src="./_next/static/7Uv-H1eeK5mnpOygBEt0K/_ssgManifest.js" defer=""></script><script src="./_next/static/7Uv-H1eeK5mnpOygBEt0K/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div style="display:flex;flex-direction:column;align-items:center;height:100vh;width:100vw"><header class="__navbar styles_navbar__ZZ0KS  "><div class="styles_container___z5z2"><a class="styles_logo___EFwE" href="/cn">walkerchi</a><div class="styles_menu__h82R1 "><ul><li><a href="/cn/me">吾</a></li><li><a href="/cn/content">所思</a></li><li><a href="/cn/function">功能</a></li><li><a href="/cn/gallery">收藏</a></li><li><a>EN</a></li></ul></div><span class="styles_trigger__qB_jc "><i></i><i></i><i></i></span></div></header><div class="styles_md-render__XMOsF"><div class="styles_banner__v8_MF"><span style="box-sizing:border-box;display:block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:absolute;top:0;left:0;bottom:0;right:0"><img type="jpg" alt="" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:cover;filter:blur(20px);background-size:cover;background-image:url(&quot;data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAbEAEAAAcAAAAAAAAAAAAAAAAAAwQGBzd1tP/EABUBAQEAAAAAAAAAAAAAAAAAAAED/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAEx/9oADAMBAAIRAxEAPwC32XxpTuuk+WEAZiVf/9k=&quot;);background-position:0% 0%"/><noscript><img type="jpg" alt="" sizes="100vw" srcSet="https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=640 640w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=750 750w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=828 828w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=1080 1080w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=1200 1200w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=1920 1920w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=2048 2048w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=3840 3840w" src="https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=3840" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:cover" loading="lazy"/></noscript></span></div><div class="styles_content__yFduY"><div class="styles_md__49sAu"></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"[华科]数据库实验5","description":"华中科技大学 数据库实验5","date":"2021-6-6","image":"https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg"},"content":"\u003ch1\u003eLab5\u003c/h1\u003e\u003cp\u003e本关任务： (1)编写一个依据人员编号计算其到达所有地点的次数(即行程表中的记录数)的自定义函数，同一人员到达同一地点多次，去几次算几次。 (2)并利用其查询至少有3条行程记录的人员。\u003c/p\u003e\u003cp\u003e为了完成本关任务，你需要掌握： (1)create function语句的语法； (2)使用自己创建的函数； (3)函数体可能用到的其它语句。\u003c/p\u003e\u003cp\u003e函数其实有多种，比如标量函数(仅返回一个值)和表函数(返回结果是表),语法也各不相同。这里，我们仅给出一个简化的创建标量函数的语法。这个简化的语法同时适用于SQL Server和MySQL。\u003c/p\u003e\u003cp\u003ecreate function语句的语法：\u003c/p\u003e\u003cp\u003ecreate function function_name([para data_type[,…]]) returns data_type begin function_body; return expression; end\u003c/p\u003e\u003cul\u003e\u003cli\u003efunction_name:函数名；\u003c/li\u003e\u003cli\u003epara:参数名；\u003c/li\u003e\u003cli\u003edata_type:参数的数据类型；\u003c/li\u003e\u003cli\u003e一个函数可以没有参数，也可以有多个。多参数间用逗号分隔。\u003c/li\u003e\u003cli\u003efunction_body:函数体。即由合法的SQL语句组成的程序段。\u003c/li\u003e\u003cli\u003eexpression:函数返回值，可以是常量、表达式，甚至是一条select语句查询的值（必须保证结果唯一);该值类型应与returns短语定义的类型相同。\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e函数一旦定义，就可以像内部函数一样使用，比如出现在select列表、表达式、以及where子句的条件中。\u003c/p\u003e\u003cp\u003e(1)用create function语句创建符合以下要求的函数：\u003c/p\u003e\u003cul\u003e\u003cli\u003e依据人员编号计算其到达所有地点的次数(即行程表中的记录数)。\u003c/li\u003e\u003cli\u003e函数名为：Count_Records。函数的参数名可以自己命名\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e(2) 利用创建的函数，仅用一条SQL语句查询在行程表中至少有3条行程记录的人员信息，查询结果依人员编号排序。\u003c/p\u003e\u003cp\u003e友情提醒：当前你处于MySQL环境下。\u003c/p\u003e\u003cp\u003e评测程序将执行你的代码段创建函数，并执行查询，然后看执行结果与预期的结果是否一致。评测程序附加有别的语句，直接调用该函数。所以，即使你的SQL语句没有使用该函数也查询出了正确结果，仍不会通过评测。\u003c/p\u003e\u003cp\u003e如果你第一次评测没有通过，请记得在下次评测前，drop掉先前创建的函数。但请你确认你真的创建成功了这个函数，只是该函数运行的结果不符合预期，你需要修改后重新创建。如果这个函数根本没创建成功，你的drop语句会抛出异常，致使程序停止运行。我给你的建议是： (1) MySQL可以使用drop function IF EXISTS function_name; (2) SQL Server可以直接将create关键词改成alter，修改函数的定义（前提仍是该函数已创建，只是没有达到预期效果。如果没有创建成功，则保留关键词create不变，修订错误语句后，重新提交即可 ）。\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-sql\"\u003edelimiter $\r\ncreate function Count_Records(pid int) returns int \r\nbegin\r\ndeclare x int;\r\nselect count(*) from itinerary where p_id=pid into x;\r\nreturn x;\r\nend$\r\ndelimiter ;\r\n\r\nselect * from person where Count_Records(id)\u003e=3 order by id;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cspan class=\"math math-inline\"\u003e\\checkmark\u003c/span\u003e\u003c/p\u003e","renderType":"md","imageProps":{"src":"https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg","width":4325,"height":1440,"type":"jpg","blurDataURL":"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAbEAEAAAcAAAAAAAAAAAAAAAAAAwQGBzd1tP/EABUBAQEAAAAAAAAAAAAAAAAAAAED/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAEx/9oADAMBAAIRAxEAPwC32XxpTuuk+WEAZiVf/9k="},"language":"cn"},"__N_SSG":true},"page":"/[lang]/content/[...slug]","query":{"lang":"cn","slug":["engineering-science","computer-science","hust","database","Lab5-md"]},"buildId":"7Uv-H1eeK5mnpOygBEt0K","assetPrefix":".","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>