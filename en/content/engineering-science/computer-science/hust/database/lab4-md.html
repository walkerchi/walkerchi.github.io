<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" href="/icon/hexogen.svg"/><title>Walkerchi | walkerchi&#x27;s homepage</title><meta name="robots" content="index,follow"/><meta name="description" content="The Homepage Website of walkerchi"/><meta property="og:title" content="Walkerchi | walkerchi&#x27;s homepage"/><meta property="og:description" content="The Homepage Website of walkerchi"/><meta name="next-head-count" content="8"/><link rel="preload" href="./_next/static/css/000780a15b7c1cbd.css" as="style"/><link rel="stylesheet" href="./_next/static/css/000780a15b7c1cbd.css" data-n-g=""/><link rel="preload" href="./_next/static/css/e9521474bbd05bad.css" as="style"/><link rel="stylesheet" href="./_next/static/css/e9521474bbd05bad.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="./_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="./_next/static/chunks/webpack-1d70a8de7a21dd19.js" defer=""></script><script src="./_next/static/chunks/framework-75db3117d1377048.js" defer=""></script><script src="./_next/static/chunks/main-30435f12318d8710.js" defer=""></script><script src="./_next/static/chunks/pages/_app-c29e8ded51aeee7d.js" defer=""></script><script src="./_next/static/chunks/4ad82c5e-0dc209747f2c5278.js" defer=""></script><script src="./_next/static/chunks/542b50fd-4032e53bb43a3093.js" defer=""></script><script src="./_next/static/chunks/675-ed166fdce2eef928.js" defer=""></script><script src="./_next/static/chunks/568-25d1c2389425a4bc.js" defer=""></script><script src="./_next/static/chunks/201-55f2f15b237a96f9.js" defer=""></script><script src="./_next/static/chunks/529-60cdf8df29f46e3c.js" defer=""></script><script src="./_next/static/chunks/pages/%5Blang%5D/content/%5B...slug%5D-6375ae090a346a72.js" defer=""></script><script src="./_next/static/7Uv-H1eeK5mnpOygBEt0K/_buildManifest.js" defer=""></script><script src="./_next/static/7Uv-H1eeK5mnpOygBEt0K/_ssgManifest.js" defer=""></script><script src="./_next/static/7Uv-H1eeK5mnpOygBEt0K/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div style="display:flex;flex-direction:column;align-items:center;height:100vh;width:100vw"><header class="__navbar styles_navbar__ZZ0KS  "><div class="styles_container___z5z2"><a class="styles_logo___EFwE" href="/en">walkerchi</a><div class="styles_menu__h82R1 "><ul><li><a href="/en/me">Me</a></li><li><a href="/en/content">Blog</a></li><li><a href="/en/function">Function</a></li><li><a href="/en/gallery">Gallery</a></li><li><a>中文</a></li></ul></div><span class="styles_trigger__qB_jc "><i></i><i></i><i></i></span></div></header><div class="styles_md-render__XMOsF"><div class="styles_banner__v8_MF"><span style="box-sizing:border-box;display:block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:absolute;top:0;left:0;bottom:0;right:0"><img type="jpg" alt="" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:cover;filter:blur(20px);background-size:cover;background-image:url(&quot;data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAbEAEAAAcAAAAAAAAAAAAAAAAAAwQGBzd1tP/EABUBAQEAAAAAAAAAAAAAAAAAAAED/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAEx/9oADAMBAAIRAxEAPwC32XxpTuuk+WEAZiVf/9k=&quot;);background-position:0% 0%"/><noscript><img type="jpg" alt="" sizes="100vw" srcSet="https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=640 640w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=750 750w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=828 828w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=1080 1080w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=1200 1200w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=1920 1920w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=2048 2048w, https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=3840 3840w" src="https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg?imwidth=3840" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:cover" loading="lazy"/></noscript></span></div><div class="styles_content__yFduY"><div class="styles_md__49sAu"></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"[华科]数据库实验4","description":"华中科技大学 数据库实验4","date":"2021-5-19","image":"https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg"},"content":"\u003ch1\u003eLab4\u003c/h1\u003e\u003ch2\u003e1\u003c/h2\u003e\u003cp\u003e隔离点的人员一旦确诊“新冠”后，将被转入医院，请 编写一个触发器，用于实现以下完整性控制规则： 当隔离表（isolation_record）中的某位隔离人员在诊断表（diagnose_record）中的诊断结果（result）为1(新冠确诊)”时，自动将隔离表中的隔离状态（state)改成3（转入医院）。\u003c/p\u003e\u003cp\u003e为了完成本关任务，你需要掌握： 对你所使用的DBMS的流程控制语句非常熟悉，包括但不限于以下内容：\u003c/p\u003e\u003cp\u003e(1)变量申明语句(如declare)；\u003c/p\u003e\u003cp\u003e(2)赋值语句（直接赋值，或用select查询的结果赋值）；\u003c/p\u003e\u003cp\u003e(3)if语句；\u003c/p\u003e\u003cp\u003e(4)while语句；\u003c/p\u003e\u003cp\u003e(5)触发器生存期内的特殊表：\u003c/p\u003e\u003cul\u003e\u003cli\u003eold和new(for MySQL, Oracle, DB2等)\u003c/li\u003e\u003cli\u003edeleted和inserted(for SQL Server )\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e(6)create trigger语句的语法；\u003c/p\u003e\u003cp\u003e(7)触发的时机：before ,after等；\u003c/p\u003e\u003cp\u003e(8)触发事件：insert,delete,update。\u003c/p\u003e\u003cp\u003e请注意，以上每项内容，在不同的DBMS中都有区别，比如： (1) create trigger 语句的语法格式不同；\u003c/p\u003e\u003cp\u003e(2) SQL Server有instead of触发器，但MySQL没有； MySQL有before触发器，但SQL Server没有。两者触发的时机虽然相同,都是在触发该触发器的那条语句(insert,delete,update)执行之前执行。但区别是：instead of触发器取代触发它的那条语句，而触发该触发器的那条语句本身并不执行。但before触发器执行完后，触发该触发器的语句本身会执行；\u003c/p\u003e\u003cp\u003e(3) SQL Server一次可以定义多个事件(insert,delete,upate三者的任意组合)驱动的触发器，但MySQL一次只能定义一个事件(insert,delte,update三选一)驱动的触发器。这意味着，如果你希望多个事件均触发完整性检查，你得创建多个触发器。\u003c/p\u003e\u003cp\u003e(4) 触发器生存周期内的特殊表名不同。\u003c/p\u003e\u003cp\u003e(5) SQL Server不允许在触发器内修改inserted或updated表的内容。但MySQL的before触发器允许修改new表的内容。比如，当发现insert或update后的数据明显错误时，可以通过修改new表的内容纠正这一错误。但我们并不建议你这么做，一个更好的方法是：拒绝插入和修改，并提示错误原因。\u003c/p\u003e\u003cp\u003e(6) SQL Server的create trigger语句必须是批处理中的第一条语句，即它之前不允许有别的语句，否则这条create trigger语句将不会执行。请在create trigger语句前，写一条GO语句，使前面的语句全部执行完。这样，create trigger语句自然成为下一批语句的第一条。 (7) MySQL虽然允许你随时定义触发器，但要求你用“DELIMITER 界符”语句指定触发器定义语句的界符（即结束符)。我们推荐你使用“;;”(即两个连续的分号)作触发器定义语句的界符。请在触发器定义结束后重新指定语句的界符(恢复为单个分号)。\u003c/p\u003e\u003cp\u003e总之，我们建议你认真阅读你所使用的DBMS的官方手册，然后再动手编写触发器，它的主体是一段程序。所以，你务必掌握该语言的各类语句，以及create trigger语句本身。\u003c/p\u003e\u003cp\u003e用create trigger语句创建符合任务要求的触发器（触发器名称自已命名）： 当隔离表（isolation_record）中的某位隔离人员在诊断表（diagnose_record）中的诊断结果（result）为1(新冠确诊)”时，自动将隔离表中的隔离状态（state)改成3（转入医院）。\u003c/p\u003e\u003cp\u003e首先，请考虑清楚触发器应该建在哪个表上； 其次，请考虑触发器执行的时机； 接着，考虑什么事件(insert,update,delete)触发这个触发器运行； 最后，正确创建触发器。\u003c/p\u003e\u003cp\u003e提醒：当前你处于MySQL环境下。\u003c/p\u003e\u003cp\u003e评测程序将执行你的语句创建触发器，然后对相关表执行insert，update操作，来触发你定义的触发器，然后查看预期的结果有没有发生。如果执行insert或update语句后，发生的结果与预期结果一致即过关。\u003c/p\u003e\u003cp\u003e如果你第一次评测没有通过，请记得在下次评测前，drop掉先前创建的触发器。\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"language-sql\"\u003edrop trigger if exists fuckyou;\r\ndrop trigger if exists fuckyoudoubletime;\r\ndelimiter $\r\ncreate trigger fuckyou \r\nbefore insert\r\non diagnose_record \r\nfor each row \r\nbegin \r\nupdate isolation_record set state=3 where isolation_record.p_id=NEW.p_id and NEW.result=1;\r\nend$\r\ndelimiter ;\r\ndelimiter $\r\ncreate trigger fuckyoudoubletime\r\nbefore update\r\non diagnose_record \r\nfor each row \r\nbegin \r\nupdate isolation_record set state=3 where isolation_record.p_id=NEW.p_id and NEW.result=1;\r\nend$\r\ndelimiter ;\n\u003c/code\u003e\u003c/pre\u003e","renderType":"md","imageProps":{"src":"https://s2.loli.net/2022/05/21/xBCITtd3PXU2gih.jpg","width":4325,"height":1440,"type":"jpg","blurDataURL":"data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAf/xAAbEAEAAAcAAAAAAAAAAAAAAAAAAwQGBzd1tP/EABUBAQEAAAAAAAAAAAAAAAAAAAED/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAEx/9oADAMBAAIRAxEAPwC32XxpTuuk+WEAZiVf/9k="},"language":"en"},"__N_SSG":true},"page":"/[lang]/content/[...slug]","query":{"lang":"en","slug":["engineering-science","computer-science","hust","database","lab4-md"]},"buildId":"7Uv-H1eeK5mnpOygBEt0K","assetPrefix":".","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>